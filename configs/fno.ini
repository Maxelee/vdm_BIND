[TRAINING]
# =============================================================================
# FNO (Fourier Neural Operator) Configuration
# =============================================================================
# 
# FNO uses spectral convolution in Fourier space, giving it a global receptive
# field that's well-suited for astrophysical data with long-range correlations.
#
# Key advantages:
# - Global receptive field captures large-scale structure
# - Spectral learning preserves power spectrum statistics
# - Resolution-invariant (train at low-res, apply at high-res)
# - Efficient O(N log N) via FFT
#

# Model selection: fno (VDM training), fno_flow (flow matching training)
model_type = fno

# FNO Architecture
# ----------------
# Variant options: FNO-S (200K), FNO-B (800K), FNO-L (3M), FNO-XL (12M)
fno_variant = FNO-B

# Or manually specify (overrides variant if hidden_channels is set):
# hidden_channels = 64
# n_layers = 6
# modes = 16  # Number of Fourier modes to keep

# Image/data settings
img_size = 128
cropsize = 128

# Conditioning
conditioning_channels = 1
large_scale_channels = 3
n_params = 35

# VDM Training settings
# ---------------------
gamma_min = -13.3
gamma_max = 5.0
noise_schedule = fixed_linear

# Loss function: mse, l1, huber
loss_type = mse

# Optimization
# ------------
learning_rate = 1e-4
weight_decay = 1e-5
lr_scheduler = cosine
warmup_steps = 1000
batch_size = 8
max_epochs = 100

# Sampling
n_sampling_steps = 256

# Regularization
dropout = 0.0

# Data
# ----
data_path = /mnt/home/mlee1/ceph/train_data_rotated2_128_cpu/train/
val_data_path = /mnt/home/mlee1/ceph/train_data_rotated2_128_cpu/val/

# Normalization (use same as other models for consistency)
normalize = true
log_transform = true

# Quantile normalization for stellar channel (optional)
quantile_path = /mnt/home/mlee1/vdm_BIND/data/quantile_normalizer_stellar.pkl

# Training settings
# -----------------
seed = 8
num_workers = 4
limit_train_batches = 1.0

# Checkpointing
model_name = fno_vdm
tb_logs = /mnt/home/mlee1/ceph/tb_logs3

# Early stopping
enable_early_stopping = true
early_stopping_patience = 50

# Callbacks
enable_gradient_monitoring = true
gradient_log_frequency = 100
enable_fid_monitoring = false

# Memory optimization
accumulate_grad_batches = 1
gradient_clip_val = 1.0
precision = 32
