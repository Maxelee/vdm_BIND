[TRAINING]
# ==============================================================================
# VDM - CUSTOM PARAMETERS Configuration
# ==============================================================================
# 
# This configuration demonstrates how to use CUSTOM parameter conditioning
# instead of the default CAMELS 35 parameters.
#
# You can specify parameters in THREE ways:
#
# 1. INLINE (in this config file):
#    param_min = 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
#    param_max = 1.0, 1.0, 1.0, 1.0, 1.0, 1.0
#
# 2. CSV FILE:
#    param_norm_path = /path/to/custom_params.csv
#    # CSV must have 'MinVal' and 'MaxVal' columns (or 'min'/'max')
#
# 3. JSON FILE:
#    param_norm_path = /path/to/custom_params.json
#    # JSON format: {"param_min": [...], "param_max": [...], "param_names": [...]}
#
# ==============================================================================

seed = 8
dataset = CustomSimulation
data_root = /path/to/your/training_data/
field = gas
boxsize = 6.25 

# ==============================================================================
# CUSTOM PARAMETER CONDITIONING (INLINE EXAMPLE)
# ==============================================================================
# 
# Example: 6 parameters for a custom simulation
#   param1: Omega_m (matter density)
#   param2: sigma_8 (clustering amplitude)
#   param3: AGN_feedback_efficiency
#   param4: SN_feedback_efficiency
#   param5: star_formation_threshold
#   param6: black_hole_seed_mass
#
# Provide min/max bounds for normalization to [0,1]

param_min = 0.1, 0.5, 0.0, 0.0, 0.1, 1e4
param_max = 0.5, 1.2, 1.0, 1.0, 10.0, 1e6

# NOTE: Ensure your training data .npz files include a 'params' array
# with shape (n_params,) matching the bounds above.

# ==============================================================================
# ALTERNATIVE: JSON FILE
# ==============================================================================
# Uncomment to use a JSON file instead of inline specification:
# param_norm_path = configs/custom_params.json
#
# JSON format:
# {
#     "param_min": [0.1, 0.5, 0.0, 0.0, 0.1, 1e4],
#     "param_max": [0.5, 1.2, 1.0, 1.0, 10.0, 1e6],
#     "param_names": [
#         "Omega_m", "sigma_8", "AGN_eff", 
#         "SN_eff", "SF_thresh", "BH_seed"
#     ]
# }

# ==============================================================================
# TRAINING HYPERPARAMETERS
# ==============================================================================

batch_size = 128
num_workers = 40
cropsize = 128
max_epochs = 200

# ==============================================================================
# LEARNING RATE
# ==============================================================================

learning_rate = 5e-5 
lr_scheduler = cosine_warmup 

# ==============================================================================
# VDM NOISE SCHEDULE
# ==============================================================================

noise_schedule = learned_nn  
gamma_min = -13.3
gamma_max = 13.0

# ==============================================================================
# DATA AUGMENTATION
# ==============================================================================

data_noise = 5e-4, 5e-4, 5e-4
antithetic_time_sampling = True

# ==============================================================================
# ARCHITECTURE
# ==============================================================================

n_blocks = 5
embedding_dim = 96
norm_groups = 8
n_attention_heads = 8 
large_scale_channels = 3
use_cross_attention = False
add_attention = True
use_fourier_features = True
legacy_fourier = False

# ==============================================================================
# LOSS CONFIGURATION
# ==============================================================================

lambdas = 1.0, 1.0, 1.0
channel_weights = 1.0, 1.0, 3.0
use_focal_loss = False
focal_gamma = 3.0  

# ==============================================================================
# PARAMETER PREDICTION (OPTIONAL)
# ==============================================================================
# Enable to train auxiliary parameter prediction head
# This can improve conditioning quality and provides interpretability

use_param_prediction = True
param_prediction_weight = 0.01

# ==============================================================================
# STELLAR NORMALIZATION
# ==============================================================================
# For custom datasets, you'll need to compute your own normalization stats
# Use: python scripts/compute_normalization.py --data_dir /path/to/data

# stellar_stats_path = /path/to/stellar_normalization_stats.npz
quantile_path = /mnt/home/mlee1/vdm_BIND/data/quantile_normalizer_stellar.pkl
use_quantile_normalization = True

# ==============================================================================
# MONITORING & EMA
# ==============================================================================

validation_plot_frequency = 500
enable_early_stopping = False
enable_fid_monitoring = False
enable_gradient_monitoring = True
gradient_log_frequency = 50
enable_ema = True
ema_decay = 0.9999
ema_update_after_step = 1000
ema_update_every = 1

# ==============================================================================
# LOGGING
# ==============================================================================

model_name = vdm_custom_params
tb_logs = /mnt/home/mlee1/ceph/tb_logs3
version = 0
precision = 16-mixed
compile_model = False
