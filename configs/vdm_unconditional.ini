[TRAINING]
# ==============================================================================
# VDM - UNCONDITIONAL Configuration
# ==============================================================================
# 
# This configuration trains a VDM model WITHOUT parameter conditioning.
# Use this for datasets where cosmological/astrophysical parameters are:
#   - Not available
#   - Not relevant to your task
#   - You want to learn an unconditional generative model
#
# The model will learn to generate baryonic fields conditioned only on:
#   - Dark matter halo density field (m_dm)
#   - Large-scale environment (large_scale)
#   - Time/noise level (built-in VDM conditioning)
#
# ==============================================================================

seed = 8
dataset = IllustrisTNG
data_root = /mnt/home/mlee1/ceph/train_data_rotated2_128_cpu/train/
field = gas
boxsize = 6.25 

# ==============================================================================
# UNCONDITIONAL MODE
# ==============================================================================
# Setting n_params = 0 or param_norm_path = none enables unconditional generation

n_params = 0
# OR: param_norm_path = none

# ==============================================================================
# TRAINING HYPERPARAMETERS
# ==============================================================================

batch_size = 128
num_workers = 40
cropsize = 128
max_epochs = 200

# ==============================================================================
# LEARNING RATE
# ==============================================================================

learning_rate = 5e-5 
lr_scheduler = cosine_warmup 

# ==============================================================================
# VDM NOISE SCHEDULE
# ==============================================================================

noise_schedule = learned_nn  
gamma_min = -13.3
gamma_max = 13.0

# ==============================================================================
# DATA AUGMENTATION
# ==============================================================================

data_noise = 5e-4, 5e-4, 5e-4
antithetic_time_sampling = True

# ==============================================================================
# ARCHITECTURE
# ==============================================================================

n_blocks = 5
embedding_dim = 96
norm_groups = 8
n_attention_heads = 8 
large_scale_channels = 3
use_cross_attention = False
add_attention = True
use_fourier_features = True
legacy_fourier = False

# ==============================================================================
# LOSS CONFIGURATION
# ==============================================================================

lambdas = 1.0, 1.0, 1.0
channel_weights = 1.0, 1.0, 3.0
use_focal_loss = False
focal_gamma = 3.0  

# ==============================================================================
# PARAMETER PREDICTION (DISABLED FOR UNCONDITIONAL)
# ==============================================================================

use_param_prediction = False

# ==============================================================================
# STELLAR NORMALIZATION
# ==============================================================================

quantile_path = /mnt/home/mlee1/vdm_BIND/data/quantile_normalizer_stellar.pkl
use_quantile_normalization = True

# ==============================================================================
# MONITORING & EMA
# ==============================================================================

validation_plot_frequency = 500
enable_early_stopping = False
enable_fid_monitoring = False
enable_gradient_monitoring = True
gradient_log_frequency = 50
enable_ema = True
ema_decay = 0.9999
ema_update_after_step = 1000
ema_update_every = 1

# ==============================================================================
# LOGGING
# ==============================================================================

model_name = vdm_unconditional
tb_logs = /mnt/home/mlee1/ceph/tb_logs3
version = 0
precision = 16-mixed
compile_model = False
